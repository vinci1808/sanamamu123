IENDTIFICATION DIVISION.
PROGRAM-ID. PROG11.
ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT EMPLOYEE-FILE ASSIGN TO EMPFILE
    ORGANIZATION IS SEQUENTIAL
    ACCESS MODE  IS SEQUENTIAL
    FILE STATUS  IS WS-FILE-STAT.
DATA DIVISION.
FILE SECTION.
FD  EMPLOYEE-FILE
    RECORD CONTAINS 50 CHARACTERS.
01  EMPLOYEE-RECORD.
    03  EMP-ID    PIC X(05).
    03  EMP-NAME  PIC X(15).
    03  EMP-LOC       PIC X(03).
    03  EMP-DOB       PIC X(08).
    03  EMP-TECH  PIC X(05).
    03  EMP-EARN  PIC 9(05)V99.
    03  EMP-DEDN  PIC 9(05)V99.
WORKING-STORAGE SECTION.
01  WS-FILE-STAT  PIC X(02).
    88  OPEN-SUCCESS        VALUE '00'.
01  WS-FILE-FLAG  PIC X(01) VALUE 'N'.
    88  END-OF-FILE         VALUE 'Y'.
PROCEDURE DIVISION.
MAIN-PARA.
    PERFORM 1000-INIT-PARA
    PERFORM 2000-PROCESS-PARA  UNTIL  END-OF-FILE
    PERFORM 3000-END-PARA
    STOP RUN.
1000-INIT-PARA.
    OPEN INPUT EMPLOYEE-FILE
    IF OPEN-SUCCESS
    DISPLAY 'FILE HAS BEEN SUCCESSFULLY OPENED'
    END-IF
    PERFORM 1500-READ-PARA.
1500-READ-PARA.
    READ EMPLOYEE-FILE
    AT END
       MOVE 'Y' TO WS-FILE-FLAG
    NOT AT END
       DISPLAY 'FILE READ SUCCESSFULLY'
    END-READ.
2000-PROCESS-PARA.
    DISPLAY 'EMP - ', EMPLOYEE-RECORD
    PERFORM 1500-READ-PARA.
3000-END-PARA.
    CLOSE EMPLOYEE-FILE.
