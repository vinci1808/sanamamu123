ENVIRONMENT-DIVISION.
INPUT-OUPUT SECTION.
FILE CONTROL.
      SELECT EMPLOYEE-MASTER ASSIGN TO 'EMPMAST'
      ORGANIZATION IS INDEXED
      RECORD KEY IS EMP-ID
      ACCESS MODE IS SEQUENTIAL
      FILE STATUS IS WS-EMP-STAT.
      SELECT INPUT-FILE ASSIGN TO 'INPFILE'
      ORGANIZATION IS SEQUENTIAL                         
      ACCESS MODE  IS SEQUENTIAL                         
      FILE STATUS  IS WS-INP-STAT. 

DATA-DIVISION
FILE SECTION.
FD EMPLOYEE-MASTER.
   RECORD CONTAINS 80 CHARACTERS
01  MASTER-RECORD.
    03  EMP-ID   PIC X(05).
    03  EMP-NAME PIC X(15).
    03  EMP-LOC  PIC X(03).
    03  EMP-DOB  PIC X(08).
    03  EMP-TECH PIC X(05).
    03  EMP-EARN PIC 9(05)V99.
    03  EMP-DEDN PIC 9(05)V99.
FD INPUT-FILE
   RECORD CONTAINS 5 CHARACTERS
01 INPUT-RECORD  PIC X(05).
    

WORKING-STORAGE DIVISION.
01 WS-EMP-STAT       PIC X(02).
    88 OPEN-SUCCESS  VALUE '00'.
01 WS-INP-STAT       PIC X(02).
    88 OPEN-SUCCESS  VALUE '00'.
01 WS-INP-FLAG       PIC X(02). VALUE 'N'.
    88 EMP-FOUND     VALUE 'Y'.
01 WS-FILE-FLAG      PIC X(01)  VALUE 'N'.
    88 END-OF-FILE   VALUE 'Y'.


PROCEDURE-DIVISION.
MAIN-PARA.
    PERFORM INIT-PARA.
    PERFORM PROCESS-PARA UNTIL END-OF-FILE.
    PERFORM END-PARA.
    STOP RUN.
INIT-PARA.
    OPEN EMPLOYEE-MASTER.
    DISPLAY WS-EMP-STAT.
    OPEN INPUT-FILE.
    DISPLAY WS-INP-STAT.
    PERFORM READ-PARA. 
READ-PARA.
     READ INPUT-FILE
      AT END
           MOVE 'Y' TO WS-FILE-FLAG
     NOT AT END
           MOVE 'N' TO WS-FILE-FLAG.
     PERFORM READ-MASTER.
READ-MASTER.
     MOVE INPUT-RECORD TO EMP-ID.
     READ EMPLOYEE-MASTER
       IF F
          MOVE 'Y' TO EMP-FOUND
          PERFORM PROCESS-PARA.
       IF NOT FOUND
          MOVE 'N' TO EMP-FOUND
          DISPLAY 'RECORD NOT FOUND.INVALID RECORD KEY=>', INPUT-RECORD.
PROCESS-PARA
     INVALID KEY           
       DISPLAY 'RECORD NOT FOUND.FILE STATUS= ', WS-EMP-STAT
     NOT INVALID KEY            
       DISPLAY 'RECORD HAS BEEN READ'
       DISPLAY MASTER-RECORD.
     END-READ.
     PERFORM END-PARA.
END-PARA.
    CLOSE EMPLOYEE-FILE.
STOP RUN.


